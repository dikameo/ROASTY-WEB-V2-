<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Roasty - Profil</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
    </style>
</head>

<body class="bg-[#faf7f3]">

    <!-- NAVBAR -->
    <nav class="w-full bg-white border-b border-[#ede7dd] py-4 sticky top-0 z-50">
        <div class="max-w-7xl mx-auto flex items-center justify-between px-6">

            <!-- Logo -->
            <div class="flex items-center space-x-2 text-xl font-semibold">
                <div class="w-4 h-4 bg-black rounded-sm"></div>
                <span>Roasty</span>
            </div>

            <div class="flex flex-1 justify-end gap-8">
                <div class="flex items-center gap-9">
                    <a class="text-[#181411] text-sm font-medium leading-normal" href="index.html">Beranda</a>
                    <a class="text-[#181411] text-sm font-medium leading-normal" href="toko.html">Toko</a>
                    <a class="text-[#181411] text-sm font-medium leading-normal" href="kursus.html">Kelas</a>
                    <a class="text-[#181411] text-sm font-medium leading-normal" href="tentang-kami.html">Tentang
                        Kami</a>
                </div>

                <div class="flex gap-2">
                    <button
                        class="flex max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-lg h-10 bg-[#f4f2f0] text-[#181411] gap-2 text-sm font-bold leading-normal tracking-[0.015em] min-w-0 px-2.5">
                        <div class="text-[#181411]" data-icon="MagnifyingGlass" data-size="20px" data-weight="regular">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" fill="currentColor"
                                viewBox="0 0 256 256">
                                <path
                                    d="M229.66,218.34l-50.07-50.06a88.11,88.11,0,1,0-11.31,11.31l50.06,50.07a8,8,0,0,0,11.32-11.32ZM40,112a72,72,0,1,1,72,72A72.08,72.08,0,0,1,40,112Z">
                                </path>
                            </svg>
                        </div>
                    </button>

                    <a href="keranjang.html"
                        class="flex max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-lg h-10 bg-[#f4f2f0] text-[#181411] gap-2 text-sm font-bold leading-normal tracking-[0.015em] min-w-0 px-2.5">
                        <div class="text-[#181411]" data-icon="ShoppingBag" data-size="20px" data-weight="regular">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" fill="currentColor"
                                viewBox="0 0 256 256">
                                <path
                                    d="M216,40H40A16,16,0,0,0,24,56V200a16,16,0,0,0,16,16H216a16,16,0,0,0,16-16V56A16,16,0,0,0,216,40Zm0,160H40V56H216V200ZM176,88a48,48,0,0,1-96,0,8,8,0,0,1,16,0,32,32,0,0,0,64,0,8,8,0,0,1,16,0Z">
                                </path>
                            </svg>
                        </div>
                    </a>
                </div>
                <div class="relative group">

                    <!-- FOTO PROFIL (BOLEH DIKLIK) -->
                    <a href="profile.html">
                        <img src="https://lh3.googleusercontent.com/aida-public/AB6AXuBObuYeumA7R4RwRqg0RuhuW9rkJ7xTq9DhCQhxnCu-6hCwSbjFH_cQbDYG72hIAqVy75yx4PHtLlo1o3SDrnTSZR7CiWZkEuvzhEF6vdcEKwf7xfeU19QppJEXhxHHv8azmy1UOHRwnqNONMQN5-YRpu0JOnrw6cJGW_a2tuOqY9frS0a2bn9NOM_vj0vf5aEjxEYj_J4fRkdWW3ntikqGzA-5F63JsW5Vy2JTFuaGj-mnrJqNcfNjtew1CmQwcolVkWbmrD_iWCk"
                            class="w-10 h-10 rounded-full cursor-pointer transition duration-200
                             hover:ring-2 hover:ring-[#a47148] hover:ring-offset-2" />
                    </a>

                    <!-- DROPDOWN (MUNCUL SAAT HOVER AREA INI) -->
                    <div class="absolute right-0 top-12 w-48 bg-white rounded-xl shadow-lg
                              border border-[#eee6df] p-3 hidden group-hover:block z-50">

                        <p class="text-sm font-semibold text-gray-700">Akun Saya</p>

                        <div class="mt-3 space-y-2 text-sm">
                            <a href="profile.html" class="block py-1 hover:text-[#a47148]">Profil</a>
                            <a href="keranjang.html" class="block py-1 hover:text-[#a47148]">Pesanan Saya</a>
                        </div>

                        <hr class="my-3 border-[#f0e8df]" />

                        <button class="w-full text-left text-sm text-red-600 hover:text-red-700">
                            Keluar
                        </button>

                    </div>

                </div>

            </div>
    </nav>

    <!-- PROFILE CONTAINER -->
    <div class="max-w-7xl mx-auto mt-12 px-6 grid grid-cols-1 lg:grid-cols-4 gap-10">

        <!-- SIDEBAR -->
        <div class="col-span-1 bg-white shadow-sm rounded-xl border border-[#eee6df] p-6 h-fit">
            <h2 class="text-lg font-semibold text-[#3b2e27] mb-4">Menu Profil</h2>
            <ul class="space-y-3 text-[15px] font-medium">
                <li><a href="profile.html" class="text-[#a47148]">Profil Saya</a></li>
                <li><a href="pesanan.html" class="hover:text-[#a47148]">Pesanan Saya</a></li>
                <li><a href="keranjang.html" class="hover:text-[#a47148]">Wishlist</a></li>
                <li><a href="#" class="hover:text-[#a47148]">Alamat</a></li>
                <li><a href="#" class="hover:text-[#a47148]">Metode Pembayaran</a></li>
                <li><a href="login.html" class="hover:text-[#a47148] text-red-600">Keluar</a></li>
            </ul>
        </div>

        <!-- MAIN PROFILE FORM -->
        <div class="col-span-1 lg:col-span-3">
            <div class="bg-white rounded-2xl shadow-sm border border-[#eee6df] p-8">

                <h2 class="text-2xl font-semibold text-[#3b2e27] mb-6">Profil Saya</h2>

                <!-- PROFILE PICTURE -->
                <div class="flex items-center space-x-6 mb-8">
                    <img id="avatarImg" src="https://i.pravatar.cc/200"
                        class="w-24 h-24 rounded-full ring-2 ring-[#a47148]" />
                    <div>
                        <p class="font-semibold text-[#3b2e27]">Feri Yusgiantoro</p>
                        <button class="mt-2 px-4 py-2 bg-[#f2ece6] rounded-xl text-sm hover:bg-[#e9e3dd]">Ganti Foto
                            Profil</button>
                    </div>
                </div>

                <!-- FORM -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label class="font-medium text-[#3b2e27]">Nama Lengkap</label>
                        <input id="nameInput" type="text"
                            class="mt-2 w-full bg-[#f5f2ee] rounded-xl p-3 focus:ring-2 focus:ring-[#a47148] outline-none"
                            value="Feri Yusgiantoro">
                    </div>

                    <div>
                        <label class="font-medium text-[#3b2e27]">Email</label>
                        <input id="emailInput" type="email"
                            class="mt-2 w-full bg-[#f5f2ee] rounded-xl p-3 focus:ring-2 focus:ring-[#a47148] outline-none"
                            value="nama@email.com">
                    </div>

                    <div>
                        <label class="font-medium text-[#3b2e27]">Nomor Telepon</label>
                        <input id="phoneInput" type="text"
                            class="mt-2 w-full bg-[#f5f2ee] rounded-xl p-3 focus:ring-2 focus:ring-[#a47148] outline-none"
                            value="08123456789">
                    </div>

                    <div>
                        <label class="font-medium text-[#3b2e27]">Tanggal Lahir</label>
                        <input id="birthInput" type="date"
                            class="mt-2 w-full bg-[#f5f2ee] rounded-xl p-3 focus:ring-2 focus:ring-[#a47148] outline-none">
                    </div>
                </div>

                <button class="mt-8 px-6 py-3 bg-[#a47148] text-white rounded-xl font-semibold hover:bg-[#8d5f3c]">
                    Simpan Perubahan
                </button>

            </div>
        </div>

    </div>

    <div class="h-20"></div>
    <script src="config.js"></script>
    <script>
        const token = localStorage.getItem('token');

        if (!token) {
            window.location.href = 'login.html';
        }

        const nameInput = document.getElementById('nameInput');
        const emailInput = document.getElementById('emailInput');
        const phoneInput = document.getElementById('phoneInput');
        const birthInput = document.getElementById('birthInput');
        const avatarImg = document.getElementById('avatarImg');

        async function fetchProfile() {
            try {
                const response = await fetch(`${CONFIG.API_BASE_URL}/profile`, {
                    headers: {
                        'Authorization': 'Bearer ' + token,
                        'Accept': 'application/json'
                    }
                });

                if (!response.ok) {
                    throw new Error('Unauthorized');
                }

                const result = await response.json();
                const user = result.data;

                nameInput.value = user.name ?? '';
                emailInput.value = user.email ?? '';
                phoneInput.value = user.phone ?? '';
                birthInput.value = user.birth_date ?? '';

                if (user.avatar) {
                    avatarImg.src = user.avatar;
                }

            } catch (error) {
                console.error(error);
                alert('Gagal memuat data profil. Silakan login ulang.');
                localStorage.removeItem('token');
                window.location.href = 'login.html';
            }
        }

        fetchProfile();
    </script>


</body>

</html>